#!/bin/bash
set -e

echo "unlinking -lcustomutils from lib64" >&2
unlink /usr/local/lib64/libcustomutils.so || true

if [[ -d /usr/local/lib64/libcustomutils ]]; then
	if [[ -L "libs" ]]; then
		echo "unlinking libs" >&2
		unlink libs
	else
		echo "removing libs" >&2
		rm -r libs
	fi
	echo "moving library directory to current" >&2
	mv /usr/local/lib64/libcustomutils libs
	echo "removing test objects, as they might be linked with -lcustomutils" >&2
	rm -f *.o
else
	echo "not fully installed, cannot uninstall" >&2
fi

cd libs && make uninstall
