#!/bin/bash
set -e

if [[ -d /usr/local/lib64/libcustomutils ]]; then
	if [[ -h "libs" ]]; then
		echo "unlinking libs" >&2
		unlink libs || true
	elif [[ -d "libs" ]]
		echo "removing libs" >&2
		rm -r libs || true
	fi
	echo "moving library directory to current" >&2
	mv /usr/local/lib64/libcustomutils libs
	echo "unlinking -lcustomutils from lib64" >&2
	unlink /usr/local/lib64/libcustomutils.so || true
	echo "removing test objects, as they might be linked with -lcustomutils" >&2
	rm -f *.o
fi

cd libs && make uninstall
