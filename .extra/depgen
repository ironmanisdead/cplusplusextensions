#!/bin/bash
if [[ "$1" =~ '.' ]]; then
	echo "invalid name: $1"
	exit 1
fi
IFS= read -d '' info <<'EOF'
#this file is automatically created and modified,
#please do not modify or delete it yourself.
EOF
declare -- rule="$(cc -M "$1.cpp")"
rule="$info"$'\n'"${rule/"$1.o"/"$1"}"
rule+=$'\n\t'"\$(if \$(wildcard .$1.mk.2),rm .$1.mk.2,$0 $*)"
rule+=$'\n\t'"gcc -std=c++2a -O3 -Wall -Wextra -o $1 $1.cpp -lstdc++ -lcustomutils"
echo "this file should only exist during make, if it still exists afterwords, please remove it" >".$1.mk.2"
echo "$rule" >".$1.mk"
